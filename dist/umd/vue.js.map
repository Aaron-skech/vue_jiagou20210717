{"version":3,"file":"vue.js","sources":["../../src/util/index.js","../../src/observer/array.js","../../src/observer/index.js","../../src/state.js","../../src/compiler/parser-html.js","../../src/compiler/index.js","../../src/init.js","../../src/index.js"],"sourcesContent":["export function isObject(data){\r\n    return typeof data === 'object' && data !==null;\r\n}\r\nexport function def(data,key,value){\r\n    Object.defineProperty(data,key,{\r\n        enumerable:false,\r\n        configurable:false,\r\n        value:value\r\n    })\r\n\r\n}","//我要重写数组的哪些方法 7个 push shift unshif pop reverse sort splice  \r\n\r\nlet oldArraymethods = Array.prototype;\r\n// value.__proto__ = arrayMethods; 向上查找 先查找自己重写的方法 如果没有就会查找 arrayMethods原型上的方法\r\n\r\nexport let arrayMethods = Object.create(oldArraymethods);\r\n\r\nconst methods =[\r\n    'push',\r\n    'shift',\r\n    'unshift',\r\n    'pop',\r\n    'sort',\r\n    'splice',\r\n    'reverse'\r\n];\r\nmethods.forEach(methods=>{\r\n    arrayMethods[methods] = function(...args){\r\n        console.log('用户调用了push方法')//AOP 切片编程\r\n           const result =  oldArraymethods[methods].apply(this,args);// 调用原生的数组方法\r\n            // push unshift 添加的元素可能还是一个对象\r\n            let  inserted;  //当前用户插入的元素\r\n            let  ob = this.__ob__;\r\n            switch(methods){\r\n                case 'push':\r\n                case 'unshift':\r\n                    inserted = args\r\n                    break;\r\n                case 'splice':  // 3个参数\r\n                     inserted = args.slice(2)//第三个参数 新增的数据\r\n                    break;\r\n                    default:\r\n                     break\r\n            };\r\n            if(inserted){\r\n                ob.observerArray(inserted)//将新增的数据继续进行观测\r\n            }\r\n           return result;\r\n    }\r\n})","import { isObject,def} from \"../util/index\";\r\nimport { arrayMethods } from './array.js';\r\nclass Observer{\r\n    // constructor(value){  // 仅仅是初始化的操作\r\n    //     // vue如果数据的层次过多 需要递归的去解析对象中的属性，依次增加set和get方法\r\n    //     // value.__ob__ = this; // 我给每一个监控过的对象都增加一个__ob__属性\r\n    //     def(value,'__ob__',this);\r\n    //     if(Array.isArray(value)){\r\n    //         // 如果是数组的话并不会对索引进行观测 因为会导致性能问题\r\n    //         // 前端开发中很少很少 去操作索引 push shift unshift \r\n    //         value.__proto__ = arrayMethods;\r\n    //         // 如果数组里放的是对象我再监控\r\n    //         this.observerArray(value);\r\n    //     }else{\r\n    //          // 对数组监控\r\n    //         this.walk(value); // 对对象进行观测\r\n    //     }\r\n    // }\r\n    // observerArray(value){ // [{}]\r\n    //     for(let i = 0; i < value.length;i++){\r\n    //         observe(value[i]);\r\n    //     }\r\n    // }\r\n      constructor(value){\r\n          //value.__ob__ = this;//我给每一个监控的对象都增加一个__ob__属性\r\n           def(value,'__ob__',this)\r\n          if(Array.isArray(value)){\r\n              //如果是数组的话 并不会对索引进行观测 因为会导致性能问题\r\n              // 前端开发中很少取操作索引 可以用 push shift unshift\r\n              // 如果数组里面放的是对象 我再进行监控\r\n              this.observerArray(value);\r\n          }else{\r\n              this.walk(value);\r\n          }\r\n      }\r\n    observerArray(value){\r\n        value.__proto__ = arrayMethods;\r\n        for(let i=0; i<value.length; i++){\r\n            observe(value[i]);\r\n        }\r\n    }\r\n    walk(data){\r\n        let keys = Object.keys(data); // [name,age,address]\r\n        // 如果这个data 不可配置 直接reurn\r\n        keys.forEach((key)=>{\r\n            defineReactive(data,key,data[key]);\r\n        });\r\n    }\r\n}\r\n\r\n\r\nfunction defineReactive(data,key,value){\r\n\r\n     observe(value); // 递归实现深度检测\r\n    Object.defineProperty(data,key,{\r\n        configurable:true,\r\n        enumerable:false,\r\n        get(){ //  获取值的时候做一些操作\r\n            return value;\r\n        },\r\n        set(newValue){ // 也可以做一些操作\r\n           \r\n            if(newValue === value) return;\r\n            observe(newValue); // 继续劫持用户设置的值，因为有可能用户设置的值是一个对象\r\n            console.log('更新数据')\r\n            value = newValue;\r\n        }\r\n    });\r\n}\r\n\r\nexport function observe(data){\r\n   \r\n     let isObj = isObject(data);\r\n     if(!isObj){\r\n         return\r\n     }\r\n     return new Observer(data);\r\n\r\n}","import { observe } from './observer/index'\r\nexport function initState(vm){\r\n\r\n    const opts = vm.$options;\r\n    if(opts.props){\r\n         initProps(vm);\r\n    };\r\n    if(opts.data){\r\n         initData(vm);\r\n    };\r\n    if(opts.methods){\r\n         initMethod(vm);\r\n    };\r\n    if(opts.computed){\r\n         initComputed(vm);\r\n    };\r\n    if(opts.watch){\r\n         initWatch(vm);\r\n    };\r\n\r\n}\r\n\r\nfunction initProps(){\r\n\r\n}\r\nfunction initData(vm){\r\n    let data = vm.$options.data;\r\n    data = vm._data = typeof data === 'function' ? data.call(vm):data;\r\n     \r\n    observe(data)\r\n    \r\n}\r\nfunction initMethod(){\r\n    \r\n}\r\nfunction initComputed(){\r\n    \r\n}\r\nfunction initWatch(){\r\n    \r\n}","const ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`; // abc-aaa\r\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`; // <aaa:asdads>\r\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); // 标签开头的正则 捕获的内容是标签名\r\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); // 匹配标签结尾的 </div>\r\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/; // 匹配属性的\r\nconst startTagClose = /^\\s*(\\/?)>/; // 匹配标签结束的 >  <div>\r\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g\r\n\r\nlet root = null; // ast语法树的树根\r\nlet currentParent; // 标识当前父亲是谁\r\nlet stack = [];\r\nconst ELEMENT_TYPE = 1;\r\nconst TEXT_TYPE = 3;\r\n\r\nfunction createASTElement(tagName, attrs) {\r\n    return {\r\n        tag: tagName,\r\n        type: ELEMENT_TYPE,\r\n        children: [],\r\n        attrs,\r\n        parent: null\r\n    }\r\n}\r\nfunction start(tagName, attrs) {\r\n    // 遇到开始标签 就创建一个ast元素s\r\n    let element = createASTElement(tagName,attrs);\r\n    if(!root){\r\n        root = element;\r\n    }\r\n    currentParent = element; // 把当前元素标记成父ast树\r\n    stack.push(element); // 将开始标签存放到栈中\r\n}\r\nfunction chars(text) {\r\n    text = text.replace(/\\s/g,'');\r\n    if(text){\r\n        currentParent.children.push({\r\n            text,\r\n            type:TEXT_TYPE\r\n        })\r\n    }\r\n}\r\nfunction end(tagName) {\r\n    let element = stack.pop(); // 拿到的是ast对象\r\n    // 我要标识当前这个p是属于这个div的儿子的\r\n    currentParent = stack[stack.length-1];\r\n    if(currentParent){\r\n        element.parent = currentParent;\r\n        currentParent.children.push(element); // 实现了一个树的父子关系\r\n    }\r\n}\r\nexport function parseHTML(html) {\r\n    // 不停的去解析html字符串\r\n    while (html) {\r\n        let textEnd = html.indexOf('<');\r\n        if (textEnd == 0) {\r\n            // 如果当前索引为0 肯定是一个标签 开始标签 结束标签\r\n            let startTagMatch = parseStartTag(); // 通过这个方法获取到匹配的结果 tagName,attrs\r\n            if (startTagMatch) {\r\n                start(startTagMatch.tagName, startTagMatch.attrs); // 1解析开始标签\r\n                continue; // 如果开始标签匹配完毕后 继续下一次 匹配\r\n            }\r\n            let endTagMatch = html.match(endTag);\r\n            if (endTagMatch) {\r\n                advance(endTagMatch[0].length);\r\n                end(endTagMatch[1]); // 2解析结束标签\r\n                continue;\r\n            }\r\n        }\r\n        let text;\r\n        if (textEnd >= 0) {\r\n            text = html.substring(0, textEnd);\r\n        }\r\n        if (text) {\r\n            advance(text.length);\r\n            chars(text); // 3解析文本\r\n        }\r\n    }\r\n    function advance(n) {\r\n        html = html.substring(n);\r\n    }\r\n    function parseStartTag() {\r\n        let start = html.match(startTagOpen);\r\n        if (start) {\r\n            const match = {\r\n                tagName: start[1],\r\n                attrs: []\r\n            }\r\n            advance(start[0].length); // 将标签删除\r\n            let end, attr;\r\n            while (!(end = html.match(startTagClose)) && (attr = html.match(attribute))) {\r\n                // 将属性进行解析\r\n                advance(attr[0].length); // 将属性去掉\r\n                match.attrs.push({\r\n                    name: attr[1],\r\n                    value: attr[3] || attr[4] || attr[5]\r\n                });\r\n            }\r\n            if (end) { // 去掉开始标签的 >\r\n                advance(end[0].length);\r\n                return match\r\n            }\r\n        }\r\n    }\r\n    return root;\r\n}\r\n","// ast语法树 是用对象来描述原生语法的   虚拟dom 用对象来描述dom节点的\r\n// ?: 匹配不捕获\r\n// argumens[0] = 匹配到的标签  arguments[1] 匹配到的标签名字\r\nimport {parseHTML} from './parser-html';\r\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g\r\nfunction genProps(attrs){ // 处理属性 拼接成属性的字符串\r\n    let str = '';\r\n    for(let i = 0; i < attrs.length;i++){\r\n        let attr = attrs[i];\r\n        if(attr.name === 'style'){\r\n            // style=\"color: red;fontSize:14px\" => {style:{color:'red'},id:name,}\r\n            let obj = {};\r\n            attr.value.split(';').forEach(item=>{\r\n                let [key,value] = item.split(':');\r\n                obj[key] = value\r\n            });\r\n            attr.value = obj;\r\n        }\r\n        str+= `${attr.name}:${JSON.stringify(attr.value)},`\r\n    }\r\n    return `{${str.slice(0,-1)}}`\r\n}\r\nfunction genChildren(el){\r\n    let children = el.children;\r\n    if(children && children.length > 0){\r\n        return `${children.map(c=>gen(c)).join(',')}`\r\n    }else{\r\n        return false;\r\n    }\r\n}\r\nfunction gen(node){\r\n    if(node.type == 1){\r\n        // 元素标签\r\n        return generate(node);\r\n    }else{\r\n        let text = node.text; //   <div>a {{  name  }} b{{age}} c</div>\r\n        let tokens = [];\r\n        let match,index;\r\n        // 每次的偏移量 buffer.split()\r\n        let lastIndex = defaultTagRE.lastIndex = 0; // 只要是全局匹配 就需要将lastIndex每次匹配的时候调到0处\r\n        while(match = defaultTagRE.exec(text)){\r\n            index = match.index;\r\n            if(index > lastIndex){\r\n                tokens.push(JSON.stringify(text.slice(lastIndex,index)));\r\n            }\r\n            tokens.push(`_s(${match[1].trim()})`);\r\n            lastIndex = index + match[0].length;\r\n        }\r\n        if(lastIndex < text.length){\r\n            tokens.push(JSON.stringify(text.slice(lastIndex)))\r\n        }\r\n        return `_v(${tokens.join('+')})`;\r\n    }\r\n}\r\nfunction generate(el){ // [{name:'id',value:'app'},{}]  {id:app,a:1,b:2}\r\n    let children = genChildren(el);\r\n    let code = `_c(\"${el.tag}\",${\r\n       el.attrs.length?genProps(el.attrs):'undefined'\r\n    }${\r\n        children? `,${children}` :''\r\n    })\r\n    `\r\n    return code;\r\n}\r\nexport function compileToFunction(template) {\r\n    // 1) 解析html字符串 将html字符串 => ast语法树\r\n    let root = parseHTML(template);\r\n    // 需要将ast语法树生成最终的render函数  就是字符串拼接 （模板引擎）\r\n    let code = generate(root);\r\n    console.log(code)\r\n    // 核心思路就是将模板转化成 下面这段字符串\r\n    //  <div id=\"app\"><p>hello {{name}}</p> hello</div>\r\n    // 将ast树 再次转化成js的语法\r\n    //  _c(\"div\",{id:app},_c(\"p\",undefined,_v('hello' + _s(name) )),_v('hello')) \r\n    // 所有的模板引擎实现 都需要new Function + with\r\n   \r\n    // vue的render 他返回的是虚拟dom\r\n    return function render(){\r\n\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n//   hellpo\r\n//      <p></p>\r\n// </div>\r\n\r\n\r\n// let root = {\r\n//     tag:'div',\r\n//     attrs:[{name:'id',value:'app'}],\r\n//     parent:null,\r\n//     type:1,\r\n//     children:[{\r\n//         tag:'p',\r\n//         attrs:[],\r\n//         parent:root,\r\n//         type:1,\r\n//         children:[\r\n//             {\r\n//                 text:'hello',\r\n//                 type:3\r\n//             }\r\n//         ]\r\n//     }]\r\n// }","import {initState} from './state'\r\n\r\nimport {compileToFunction} from './compiler/index.js'\r\n\r\n// 在原型上添加一个init方法\r\nexport function initMixin(Vue){\r\n    // 初始化流程\r\n    Vue.prototype._init = function (options) {\r\n        // 数据的劫持\r\n        const vm = this; // vue中使用 this.$options 指代的就是用户传递的属性\r\n        vm.$options = options;\r\n\r\n        // 初始化状态\r\n        initState(vm); // 分割代码\r\n\r\n        // 如果用户传入了el属性 需要将页面渲染出来\r\n        // 如果用户传入了el 就要实现挂载流程\r\n\r\n        if(vm.$options.el){\r\n            vm.$mount(vm.$options.el);\r\n        }\r\n    }\r\n    Vue.prototype.$mount = function (el) {\r\n        const vm = this;\r\n        const options = vm.$options;\r\n        el = document.querySelector(el); \r\n        // 默认先会查找有没有render方法，没有render 会 采用template template也没有就用el中的内容\r\n        if(!options.render){\r\n            // 对模板进行编译\r\n            let template = options.template; // 取出模板\r\n            if(!template && el){\r\n                template = el.outerHTML;\r\n            }\r\n            const render = compileToFunction(template);\r\n            options.render = render;\r\n            // 我们需要将template 转化成render方法 vue1.0 2.0虚拟dom \r\n            console.log(render);\r\n        }\r\n        \r\n      \r\n    }\r\n}","import { initMixin } from './init.js'\r\n\r\nfunction Vue(options){\r\n    this._init(options);\r\n\r\n}\r\n \r\ninitMixin(Vue);\r\n\r\nexport default Vue;"],"names":["isObject","data","def","key","value","Object","defineProperty","enumerable","configurable","oldArraymethods","Array","prototype","arrayMethods","create","methods","forEach","args","console","log","result","apply","inserted","ob","__ob__","slice","observerArray","Observer","constructor","isArray","walk","__proto__","i","length","observe","keys","defineReactive","get","set","newValue","isObj","initState","vm","opts","$options","props","initData","computed","watch","_data","call","ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","root","currentParent","stack","ELEMENT_TYPE","TEXT_TYPE","createASTElement","tagName","attrs","tag","type","children","parent","start","element","push","chars","text","replace","end","pop","parseHTML","html","textEnd","indexOf","startTagMatch","parseStartTag","endTagMatch","match","advance","substring","n","attr","name","defaultTagRE","genProps","str","obj","split","item","JSON","stringify","genChildren","el","map","c","gen","join","node","generate","tokens","index","lastIndex","exec","trim","code","compileToFunction","template","render","initMixin","Vue","_init","options","$mount","document","querySelector","outerHTML"],"mappings":"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"}